---
variant: fcos
version: 1.3.0
passwd:
  users:
    - name: localanthony
      ssh_authorized_keys:
        - ${localanthony_ssh_key}
storage:
  filesystems:
    - device: /dev/disk/by-label/ROOT
      format: btrfs
      path: /home
      wipe_filesystem: false
      mount_options:
        - subvol=/@/home
  files:
    - path: /etc/hostname
      mode: 0644
      overwrite: true
      contents:
        inline: test-${count}
    - path: /etc/transactional-update.conf
      mode: 0644
      overwrite: true
      contents:
        inline: REBOOT_METHOD=kured
    - path: /etc/sudoers.d/localanthony
      contents:
        inline: "localanthony ALL=(ALL) NOPASSWD: ALL"
    - path: /run/combustion/mount/script/raw
      mode: 0493
      contents:
        inline: |
          #!/bin/bash
          exec > >(exec tee -a /dev/tty0) 2>&1
          zypper --non-interactive addrepo https://download.opensuse.org/repositories/home:anthr76:kubernetes/openSUSE_Tumbleweed/home:anthr76:kubernetes.repo
          zypper --non-interactive --gpg-auto-import-keys refresh
          zypper --non-interactive --gpg-auto-import-keys install python38-rpm open-iscsi python3-openshift inotify-tools terminfo
